package cn.edu.buaa.act.sdp.malwaredetector.util;

import android.util.Log;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;

/**
 * Created by yaodh on 2015/1/16.
 */
public class AppLog {
    private static boolean LOG_SWITCH = true;
    private static boolean LOG_WRITE_TO_FILE = true;
    private static String LOG_PATH = "/sdcard/MalwareDetector/";
//    private static String LOG_FILE_NAME = "log.txt";

    public static void log(String tag, String msg, char level) {
        log(tag, msg, level, "static-log.txt");
    }

    public static void log(String tag, String msg, char level, String fileName) {
        if(!LOG_SWITCH) {
            return;
        }
        switch (level) {
            case 'e':
                Log.e(tag, msg);
                break;
            case 'w':
                Log.w(tag, msg);
                break;
            case 'd':
                Log.d(tag, msg);
                break;
            case 'i':
                Log.i(tag, msg);
                break;
        }
        if(LOG_WRITE_TO_FILE) {
            writeLogToFile(tag, msg, level, fileName);
        }
    }

    public static void writeLogToFile(String tag, String msg, char level, String fileName) {
        Date nowtime = new Date();
        SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        String needWriteMessage = format.format(nowtime) + " " + level + ": " + tag + " " + msg;

        File file = new File(LOG_PATH, fileName);
        try {
            BufferedWriter bufWriter = new BufferedWriter(new FileWriter(file, true));
            bufWriter.write(needWriteMessage);
            bufWriter.newLine();
            bufWriter.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
